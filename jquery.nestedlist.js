jQuery.fn.shift=function(a,b){var c=parseInt(this.css("left")),d=isNaN(c)?a:c+a;b?this.animate({left:d},b):this.css({left:d})},jQuery.fn.nestedList=function(a){function b(){return!1}function c(a,b){for(var c,d=a.find(b||"li:not(.leaf) > a:first-of-type"),e=d.length;e--;)c=d.eq(e),c.replaceWith(c.html())}function d(a,b){a.find(b||".leaf a:first-of-type").each(function(){var a=$(this);a.parents(".leaf:first").click(function(){return document.location.href=a.attr("href"),!1}).css("cursor","pointer")})}function e(e){function f(a,b){for(var c=b.children(),d=c.filter("li"),f=0,g=0;g<d.length;g+=1)f+=d.eq(g).outerHeight();return e.height(f),d}function h(){return l(),!1}function i(){o.off("click",h),o.click(b)}function j(a){p&&p.removeClass("active"),p=a?a.addClass("active"):!1}function k(b){if(nextList=b.children("ul"),a.onBeforeChange(1,nextList,e),j(b),nextList.length){nextList.show(),a.upButtonShow(o,nextList);var c=b.siblings(),d=nextList.find("li");c.length+1>d.length&&c.slice(-0,c.length-d.length).hide(),i(),a.shiftAnimation.complete=function(){o.click(h),a.onAfterChange(1,nextList,e)},e.shift(-r,a.shiftAnimation),f(e,nextList)}}function l(b){if(p){var c=p.children("ul"),d=p.parent("ul");return a.onBeforeChange(-1,d,e),p.siblings().show(),d.hasClass(n)?(j(!1),o.hide()):(a.upButtonShow(o,d),j(d.parent("li"))),f(e,d),i(),!b&&a.shiftAnimation?(a.shiftAnimation.complete=function(){o.click(h),c.hide(),a.onAfterChange(-1,d,e)},e.shift(r,a.shiftAnimation)):(e.shift(r,!1),c.hide()),!0}return!1}function m(a){var b=$(this);return b.hasClass("active")||e.is(":animated")?!1:(k(b),void a.stopPropagation())}var n=g();e.addClass(n);var o,p=!1;a&&a.upButtonSelector?(o="string"==typeof a.upButtonSelector?e.nextAll(a.upButtonSelector):a.upButtonSelector,o.hide()):(o=e.nextAll(".nestedlist-up"),1==o.length?o.remove():o=$("<li>back</li>").addClass("nestedlist-up"));var q={upButtonShow:function(a,b){b.prepend(a)},onBeforeChange:function(){},onAfterChange:function(){},shiftAnimation:{},noScriptLinks:!1,linkListItems:!0};a="object"==typeof a?$.extend(q,a):q;var r=e.outerWidth();return e.css({position:"relative"}),e.find("ul").css({position:"absolute",left:r+"px",top:"0px"}).hide(),e.find("li:not(:has(ul))").addClass("leaf").click(function(a){a.stopPropagation()}),e.find("li:not(.leaf)").hover(function(a){$(this).addClass("hover"),a.stopPropagation()},function(a){$(this).removeClass("hover"),a.stopPropagation()}).click(m),a.noScriptLinks&&c(e,"string"==typeof a.noScriptLinks&&a.noScriptLinks),a.linkListItems&&d(e,a&&a.leafItemLink),{container:e,toplevelClass:n,closeList:l,openList:k}}function f(){for(var a=0;a<h.length;a+=1)for(;h[a].closeList(!0););}var g=function(){var a=0;return function(){return a+=1,"nestedlist-"+a}}(),h=$.map(this,function(a){return e($(a))});return{nestedLists:h,closeAll:f}};