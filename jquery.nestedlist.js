jQuery.fn.shift=function(t,n){var i=parseInt(this.css("left")),e=isNaN(i)?t:i+t;n?this.animate({left:e},n):this.css({left:e})},jQuery.fn.nestedList=function(t){function n(){return!1}function e(t,n){for(var i,e=t.find(n||"li:not(.leaf) > a:first-of-type"),o=e.length;o--;)i=e.eq(o),i.replaceWith(i.html())}function o(t,n){t.find(n||".leaf a:first-of-type").each(function(){var t=$(this);t.parents(".leaf:first()").click(function(){return document.location.href=t.attr("href"),!1}).css("cursor","pointer")})}function s(s){function r(t,n){var e=n.children(),o=e.filter("li"),r=0;for(i=0;i<o.length;i+=1)r+=o.outerHeight();return s.height(r),o}function l(){return h(),!1}function a(){g.off("click",l),g.click(n)}function c(t){v&&v.removeClass("active"),v=t?t.addClass("active"):!1}function u(n){if(nextList=n.children("ul"),t.onBeforeChange(1,nextList,s),c(n),nextList.length){nextList.show(),t.upButtonShow(g,nextList);var i=n.siblings(),e=nextList.find("li");i.length+1>e.length&&i.slice(-0,i.length-e.length).hide(),a(),t.shiftAnimation.complete=function(){g.click(l),t.onAfterChange(1,nextList,s)},s.shift(-m,t.shiftAnimation),r(s,nextList)}}function h(n){if(v){var i=v.children("ul"),e=v.parent("ul");return t.onBeforeChange(-1,e,s),v.siblings().show(),e.hasClass(d)?c(!1):(t.upButtonShow(g,e),c(e.parent("li"))),r(s,e),a(),!n&&t.shiftAnimation?(t.shiftAnimation.complete=function(){g.click(l),i.hide(),t.onAfterChange(-1,e,s)},s.shift(m,t.shiftAnimation)):(s.shift(m,!1),i.hide()),!0}return!1}function p(t){var n=$(this);return s.is(":animated")?!1:(u(n),void t.stopPropagation())}var d=f();s.addClass(d);var g,v=!1;t&&t.upButtonSelector?g="string"==typeof g?$(t.upButtonSelector):t.upButtonSelector:(g=s.nextAll(".nestedlist-up"),1==g.length?g.remove():g=$("<li>back</li>").addClass("nestedlist-up"));var L={upButtonShow:function(t,n){n.prepend(t)},onBeforeChange:function(){},onAfterChange:function(){},shiftAnimation:{},noScriptLinks:!1,linkListItems:!0};t="object"==typeof t?$.extend(L,t):L;var m=s.outerWidth();return s.css({position:"relative"}),s.find("ul").css({position:"absolute",left:m+"px",top:"0px"}).hide(),s.find("li:not(:has(ul))").addClass("leaf").click(function(t){t.stopPropagation()}),s.find("li:not(.leaf)").hover(function(t){$(this).addClass("hover"),t.stopPropagation()},function(t){$(this).removeClass("hover"),t.stopPropagation()}).click(p),t.noScriptLinks&&e(s,"string"==typeof t.noScriptLinks&&t.noScriptLinks),t.linkListItems&&o(s,t&&t.leafItemLink),{container:s,toplevelClass:d,closeList:h,openList:u}}function r(){for(var t=0;t<l.length;t+=1)for(;l[t].closeList(!0););}var f=function(){var t=0;return function(){return t+=1,"nestedlist-"+t}}(),l=$.map(this,function(t){return s($(t))});return{nestedLists:l,closeAll:r}};